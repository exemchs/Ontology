---
phase: 08-product-ux-refinement
plan: 07
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/users/UsersPage.tsx
  - src/components/users/AccessControlTab.tsx
  - src/components/users/MenuConfigTab.tsx
  - src/components/users/UserTable.tsx
autonomous: true
requirements:
  - UXR-06

must_haves:
  truths:
    - "User Management has 4 tabs: Namespaces, Users, Access Control, Menu Config"
    - "Users tab combines regular users and admins with a role column distinguishing them"
    - "Access Control tab shows groups and permissions in a combined view"
    - "Menu Config tab shows system menu configuration toggles"
  artifacts:
    - path: "src/components/users/AccessControlTab.tsx"
      provides: "Groups + permissions combined view with mock data"
      min_lines: 50
    - path: "src/components/users/MenuConfigTab.tsx"
      provides: "System menu configuration toggle list"
      min_lines: 40
    - path: "src/components/users/UsersPage.tsx"
      provides: "4-tab user management page"
      contains: "Access Control"
  key_links:
    - from: "src/components/users/UsersPage.tsx"
      to: "src/components/users/AccessControlTab.tsx"
      via: "Tab content render"
      pattern: "AccessControlTab"
    - from: "src/components/users/UsersPage.tsx"
      to: "src/components/users/MenuConfigTab.tsx"
      via: "Tab content render"
      pattern: "MenuConfigTab"
---

<objective>
Redesign User Management from 2-tab to 4-tab layout: Namespaces, Users (combined regular+admin), Access Control (groups+permissions), and Menu Config (system menu settings).

Purpose: Provides a comprehensive admin experience with proper separation of namespace management, user management, access control, and system configuration.
Output: 2 new tab components + restructured UsersPage.
</objective>

<execution_context>
@/Users/chs/.claude/get-shit-done/workflows/execute-plan.md
@/Users/chs/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/components/users/UsersPage.tsx
@src/components/users/UserTable.tsx
@src/data/namespace-data.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AccessControlTab and MenuConfigTab components</name>
  <files>
    src/components/users/AccessControlTab.tsx
    src/components/users/MenuConfigTab.tsx
  </files>
  <action>
1. **AccessControlTab.tsx** (`"use client"`):
   - Functional-looking mock UI with hardcoded data (per research recommendation).
   - Two sections in a vertical layout:

   **Groups Section:**
   - Table with columns: Group Name, Description, Members Count, Created Date
   - Hardcoded groups: "Administrators" (3 members), "Data Engineers" (5 members), "Analysts" (8 members), "Auditors" (2 members)
   - Each row has "Edit" and "Delete" buttons (toast "Action not available in POC" on click)
   - "Add Group" button at top (toast on click)

   **Permissions Matrix:**
   - Table/grid with rows = groups, columns = permissions (Read Schema, Write Schema, Execute Query, View PII, Manage Users, System Config)
   - Checkboxes indicating which group has which permission
   - Hardcoded: Administrators=all, Data Engineers=read+write+query, Analysts=read+query, Auditors=read+viewPII
   - Checkboxes are interactive but changes show toast "Changes not persisted in POC"
   - Use shadcn `Checkbox` component

   - Card wrappers for each section.

2. **MenuConfigTab.tsx** (`"use client"`):
   - Functional-looking mock UI for system menu settings.
   - List of menu items matching navigation structure:
     - Dashboard, GPU Monitoring, Graph Cluster, Ontology Studio, Query Console, Data Import, User Management
   - Each row: menu item name + icon + toggle Switch (shadcn `Switch`) for enabled/disabled
   - Additional settings:
     - "Default Landing Page" dropdown (shadcn `Select`) with page options
     - "Sidebar Default State" toggle: Expanded / Collapsed
     - "Show Welcome Popup" toggle
   - All toggles use `useState` for local interactivity but changes are not persisted.
   - Toast on save button: "Configuration saved (mock)"
   - Card wrapper with "Menu Configuration" title.
  </action>
  <verify>
    - AccessControlTab.tsx exists with groups table + permissions matrix
    - MenuConfigTab.tsx exists with menu toggle list + settings
    - Both have `"use client"` directive
    - `npx tsc --noEmit` passes
  </verify>
  <done>AccessControlTab shows groups table with 4 groups and 6-column permissions matrix; MenuConfigTab shows 7 menu items with enable/disable toggles plus system settings; both are interactive with mock toast feedback</done>
</task>

<task type="auto">
  <name>Task 2: Restructure UsersPage to 4-tab layout and update UserTable</name>
  <files>
    src/components/users/UsersPage.tsx
    src/components/users/UserTable.tsx
  </files>
  <action>
1. **Update UsersPage.tsx**:
   - Current: 2 tabs (Users, Namespaces with super_admin gate).
   - New: 4 tabs (Namespaces, Users, Access Control, Menu Config).

   - Import AccessControlTab and MenuConfigTab.
   - Use shadcn `Tabs`, `TabsList`, `TabsTrigger`, `TabsContent` (existing pattern).
   - Tab order: Namespaces | Users | Access Control | Menu Config
   - Default active tab: "Users"

   - Namespaces tab: Keep existing namespace table content (NamespaceTable or equivalent)
   - Users tab: Keep existing UserTable
   - Access Control tab: `<AccessControlTab />`
   - Menu Config tab: `<MenuConfigTab />`

   - Remove super_admin gate for namespace tab visibility (all tabs visible to all roles for POC demo purposes — the AccessControl tab conceptually handles permissions)
   - Or keep subtle role-based behavior: show all 4 tabs but Access Control and Menu Config show a "Requires admin access" message for non-super_admin roles

2. **Update UserTable.tsx** if needed:
   - Ensure "role" column is prominent and clearly distinguishes admins from regular users
   - Current implementation from Phase 6 already has role badges — verify and enhance if needed
   - Add a visual separator or grouping between admin and regular users (e.g., admin users at top with subtle background highlight)
   - If the table currently has separate admin/user views, merge them into a single table with role column

3. Page title: "User Management" (already set in navigation).
  </action>
  <verify>
    - UsersPage has 4 tab triggers visible
    - Clicking each tab shows correct content
    - `npm run build` succeeds
    - UserTable shows role column
  </verify>
  <done>UsersPage restructured with 4 tabs (Namespaces/Users/Access Control/Menu Config); all tabs render content; UserTable shows combined admin+user list with role column; Access Control and Menu Config provide mock admin UIs</done>
</task>

</tasks>

<verification>
- UsersPage.tsx renders 4 tabs
- AccessControlTab.tsx and MenuConfigTab.tsx exist
- All tab content renders without errors
- `npm run build` passes
</verification>

<success_criteria>
- 4 tabs visible: Namespaces, Users, Access Control, Menu Config
- Users tab shows combined user+admin table with role column
- Access Control tab shows groups table + permissions matrix with interactive checkboxes
- Menu Config tab shows menu toggles + system settings
- Interactive elements provide toast feedback
</success_criteria>

<output>
After completion, create `.planning/phases/08-product-ux-refinement/08-07-SUMMARY.md`
</output>
